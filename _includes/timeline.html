<!-- Tree of Works Timeline (3-Track) -->
<section class="page-section" id="timeline">
  <div class="container">
    <div class="row">
      <div class="col-lg-12 text-center">
        <h2 class="section-heading text-uppercase">作品时间树</h2>
        <h3 class="section-subheading text-muted">我们的创意发展历程</h3>
      </div>
    </div>

    <div class="tree-container" id="tree-container">
      <!-- Filter Labels (Top of Trunk) -->
      <div class="tree-filters">
        <div class="filter-btn school" data-filter="school">学校作品</div>
        <div class="filter-btn personal" data-filter="personal">个人作品</div>
        <div class="filter-btn team" data-filter="team">团队作品</div>
      </div>

      <!-- Bundled Trunk (3 Lines) -->
      <div class="tree-trunk-bundle">
        <div class="trunk-line school"></div>
        <div class="trunk-line personal"></div>
        <div class="trunk-line team"></div>
      </div>

      {% assign sorted_projects = site.portfolio | sort: 'date' | reverse %}
      {% for project in sorted_projects %}
      {% assign remainder = forloop.index | modulo: 2 %}
      {% assign catIndex = forloop.index0 | modulo: 3 %}
      {% if catIndex == 0 %}{% assign category = "school" %}{% assign catText = "学校作品" %}{% endif %}
      {% if catIndex == 1 %}{% assign category = "personal" %}{% assign catText = "个人作品" %}{% endif %}
      {% if catIndex == 2 %}{% assign category = "team" %}{% assign catText = "团队作品" %}{% endif %}

      <div class="tree-item {% if remainder == 0 %}right{% else %}left{% endif %} {{ category }}-item">
        <div class="tree-branch">
          <span class="branch-date">{{ project.date | date: "%Y.%m.%d" }}</span>
        </div>
        <a class="tree-content" data-toggle="modal" data-target="#p-{{ project.caption.title | slugify }}"
          href="#p-{{ project.caption.title | slugify }}" style="text-decoration: none; color: inherit;">
          <div class="tree-img-wrapper">
            <img src="{{ site.baseurl }}/{{ project.caption.thumbnail }}" alt="{{ project.caption.title }}">
          </div>
          <div class="tree-text">
            <h4>{{ project.caption.title }}</h4>
            <span class="project-tag">{{ catText }}</span>
            <p>{{ project.caption.subtitle }}</p>
          </div>
        </a>
      </div>
      {% endfor %}

      <!-- Growth Ending Node -->
      <div class="tree-end-node">
        <span>未来</span>
      </div>
    </div>
  </div>
</section>